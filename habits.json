
---

## `app.py`

```python
import argparse
import json
from datetime import datetime
from pathlib import Path

DATA_FILE = Path("habits.json")


def load_data():
    if not DATA_FILE.exists():
        return []
    try:
        with DATA_FILE.open("r", encoding="utf-8") as f:
            return json.load(f)
    except json.JSONDecodeError:
        # æ–‡ä»¶åäº†ä¹Ÿä¸å´©ï¼Œç›´æ¥ä»ç©ºå¼€å§‹
        return []


def save_data(records):
    with DATA_FILE.open("w", encoding="utf-8") as f:
        json.dump(records, f, ensure_ascii=False, indent=2)


def cmd_add(text: str):
    records = load_data()
    record = {
        "time": datetime.now().isoformat(timespec="seconds"),
        "text": text,
    }
    records.append(record)
    save_data(records)
    print("âœ… å·²è®°å½•ï¼š", text)


def cmd_list(limit: int):
    records = load_data()
    if not records:
        print("è¿˜æ²¡æœ‰ä»»ä½•è®°å½•ï¼Œå…ˆæ¥ä¸€æ¡ï¼špython app.py add \"ä»Šå¤©å¹²äº†å•¥ï¼Ÿ\"")
        return

    print(f"æœ€è¿‘ {min(limit, len(records))} æ¡è®°å½•ï¼š")
    for r in records[-limit:]:
        print(f"- [{r['time']}] {r['text']}")


def main():
    parser = argparse.ArgumentParser(
        description="ä¸€ä¸ªè¶…å°çš„å‘½ä»¤è¡Œä¹ æƒ¯è®°å½•å™¨ï¼ˆé¡ºä¾¿å¸®ä½ åˆ· GitHub è´¡çŒ® ğŸ˜„ï¼‰"
    )
    subparsers = parser.add_subparsers(dest="command", required=True)

    # add å­å‘½ä»¤
    add_parser = subparsers.add_parser("add", help="æ·»åŠ ä¸€æ¡ä¹ æƒ¯/äº‹ä»¶è®°å½•")
    add_parser.add_argument("text", type=str, help="è¦è®°å½•çš„å†…å®¹")

    # list å­å‘½ä»¤
    list_parser = subparsers.add_parser("list", help="æŸ¥çœ‹æœ€è¿‘çš„è®°å½•")
    list_parser.add_argument(
        "--limit",
        type=int,
        default=10,
        help="æ˜¾ç¤ºçš„æœ€å¤§æ¡æ•°ï¼ˆé»˜è®¤ 10ï¼‰",
    )

    args = parser.parse_args()

    if args.command == "add":
        cmd_add(args.text)
    elif args.command == "list":
        cmd_list(args.limit)


if __name__ == "__main__":
    main()
